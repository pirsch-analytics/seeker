{{define "tree-node"}}
    {{$page := .page}}

    <ul>
        {{range .sections}}
            <li class="menu-node {{if eq $page .}}active{{end}}">
                <a href="{{.RelPermalink}}">{{.Title}}</a>
                {{if gt (len .Pages) 0}}
                    {{template "tree-node" dict "sections" .Pages "page" $page}}
                {{end}}
            </li>
        {{end}}
    </ul>
{{end}}

<div class="menu">
    {{$page := .}}
    {{template "tree-node" dict "sections" .Site.Home.Sections "page" $page}}
</div>
